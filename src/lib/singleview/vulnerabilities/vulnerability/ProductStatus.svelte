<script lang="ts">
  import Collapsible from "$lib/Collapsible.svelte";
  import ValueList from "$lib/ValueList.svelte";
  export let vulnerability: any;
</script>

<Collapsible header="Product status" level="4">
  <div class="status">
    {#if vulnerability.product_status?.fist_affected}
      <ValueList label="First affected" values={vulnerability.product_status?.fist_affected} />
    {/if}
    {#if vulnerability.product_status?.first_fixed}
      <ValueList label="First fixed" values={vulnerability.product_status?.first_fixed} />
    {/if}
    {#if vulnerability.product_status?.fixed}
      <ValueList label="Fixed" values={vulnerability.product_status?.fixed} />
    {/if}
    {#if vulnerability.product_status?.under_investigation}
      <ValueList
        label="Under investigation"
        values={vulnerability.product_status?.under_invenstigation}
      />
    {/if}
    {#if vulnerability.product_status?.known_affected}
      <ValueList label="Known affected" values={vulnerability.product_status?.known_affected} />
    {/if}
    {#if vulnerability.product_status?.known_not_affected}
      <ValueList
        label="Known not affected"
        values={vulnerability.product_status?.known_not_affected}
      />
    {/if}
    {#if vulnerability.product_status?.last_affected}
      <ValueList label="Last affected" values={vulnerability.product_status?.last_affected} />
    {/if}
    {#if vulnerability.product_status?.recommended}
      <ValueList label="Recommended" values={vulnerability.product_status?.recommended} />
    {/if}
  </div>
</Collapsible>

<style>
  .status {
    margin-top: 1.5rem;
  }
</style>
