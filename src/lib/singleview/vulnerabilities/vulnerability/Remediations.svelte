<script lang="ts">
  import Collapsible from "$lib/Collapsible.svelte";
  import ValueField from "$lib/singleview/ValueField.svelte";
  import ValueList from "$lib/singleview/ValueList.svelte";
  export let vulnerability: any;
</script>

<Collapsible header="Remediations" level="4">
  {#each vulnerability.remediations as remediation}
    <Collapsible header="Category: {remediation.category}" level="5">
      <div class="spacer" />
      {#if remediation.date}
        <ValueField label="Date" value={remediation.date} />
      {/if}
      <div class="">
        <ValueField label="Details" value={remediation.details} />
      </div>
      {#if remediation.entitlements}
        <ValueList label="Entitlements" values={remediation.entitlements} />
      {/if}
      {#if remediation.group_ids}
        <ValueList label="Group IDs" values={remediation.group_ids} />
      {/if}
      {#if remediation.product_ids}
        <ValueList label="Product IDs" values={remediation.product_ids} />
      {/if}
      {#if remediation.restart_required}
        <div class="">
          <h6>Restart_required</h6>
          <p>{remediation.restart_required.category}</p>
          {#if remediation.restart_required.details}
            <p>{remediation.restart_required.details}</p>
          {/if}
        </div>
      {/if}
      {#if remediation.url}
        <ValueField label="Url" value={remediation.url} />
      {/if}
    </Collapsible>
  {/each}
</Collapsible>

<style>
  .spacer {
    margin-top: 2em;
  }
  h6 {
    line-height: 0.3em;
    font-size: large;
  }
  p {
    margin-left: 4rem;
  }
</style>
