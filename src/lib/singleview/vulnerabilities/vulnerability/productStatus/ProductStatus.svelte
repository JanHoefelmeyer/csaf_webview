<script lang="ts">
  import Collapsible from "$lib/Collapsible.svelte";
  import ProductStatusValueList from "./ProductStatusValueList.svelte";
  export let vulnerability: any;
</script>

<Collapsible header="Product status" level="4">
  <div class="status">
    {#if vulnerability.product_status?.fist_affected}
      <ProductStatusValueList
        label="First affected"
        values={vulnerability.product_status?.fist_affected}
      />
    {/if}
    {#if vulnerability.product_status?.first_fixed}
      <ProductStatusValueList
        label="First fixed"
        values={vulnerability.product_status?.first_fixed}
      />
    {/if}
    {#if vulnerability.product_status?.fixed}
      <ProductStatusValueList label="Fixed" values={vulnerability.product_status?.fixed} />
    {/if}
    {#if vulnerability.product_status?.under_investigation}
      <ProductStatusValueList
        label="Under investigation"
        values={vulnerability.product_status?.under_invenstigation}
      />
    {/if}
    {#if vulnerability.product_status?.known_affected}
      <ProductStatusValueList
        label="Known affected"
        values={vulnerability.product_status?.known_affected}
      />
    {/if}
    {#if vulnerability.product_status?.known_not_affected}
      <ProductStatusValueList
        label="Known not affected"
        values={vulnerability.product_status?.known_not_affected}
      />
    {/if}
    {#if vulnerability.product_status?.last_affected}
      <ProductStatusValueList
        label="Last affected"
        values={vulnerability.product_status?.last_affected}
      />
    {/if}
    {#if vulnerability.product_status?.recommended}
      <ProductStatusValueList
        label="Recommended"
        values={vulnerability.product_status?.recommended}
      />
    {/if}
  </div>
</Collapsible>

<style>
  .status {
    margin-top: 1.5rem;
  }
</style>
