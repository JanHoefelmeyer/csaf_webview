<script lang="ts">
  import Collapsible from "$lib/Collapsible.svelte";
  import CVSSV2 from "./CVSSV2.svelte";
  export let vulnerability: any;
</script>

<Collapsible header="Scores" level="4">
  {#each vulnerability.scores as score, index}
    <Collapsible header="Score {index + 1}" level="5">
      {#if score.cvss_v2}
        <CVSSV2 {score} />
      {/if}
      {#if score.cvss_v3}
        <Collapsible header="CVSS V3" level="5">CVSSv3</Collapsible>
      {/if}
      <div class="spacer" />
      {#if score.products}
        <div class="">
          <h6>Product IDs</h6>
          <ul>
            {#each score.products as pid}
              <li>{pid}</li>
            {/each}
          </ul>
        </div>
      {/if}
    </Collapsible>
  {/each}
</Collapsible>

<style>
  .spacer {
    margin-top: 1.5em;
  }
  h6 {
    line-height: 0.3em;
    font-size: large;
  }
  p {
    margin-left: 4rem;
  }
  ul {
    list-style-type: none;
    margin-block-end: 0px;
  }
</style>
